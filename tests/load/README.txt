================================================================================
LOAD TESTING - README
================================================================================

ЦЕЛЬ

Замерить производительность приложения ДО и ПОСЛЕ рефакторинга для сравнения.

================================================================================
БЫСТРЫЙ СТАРТ
================================================================================

УСТАНОВКА ЗАВИСИМОСТЕЙ

cd backend
poetry install

BASELINE ТЕСТИРОВАНИЕ (ДО рефакторинга)

1. Запустить baseline тесты:
   run_baseline_test.bat

2. Результаты сохранятся в:
   tests/load/results/baseline/

РЕФАКТОРИНГ

Выполнить все оптимизации из IMPLEMENTATION_PRIORITY.txt

OPTIMIZED ТЕСТИРОВАНИЕ (ПОСЛЕ рефакторинга)

1. Запустить optimized тесты:
   run_optimized_test.bat

2. Результаты сохранятся в:
   tests/load/results/optimized/

3. Автоматически создастся отчет сравнения:
   tests/load/results/comparison_report.txt

================================================================================
РУЧНОЙ ЗАПУСК
================================================================================

ЗАПУСК ТЕСТОВОГО ОКРУЖЕНИЯ

docker-compose -f docker-compose.test.yml up -d

ПРИМЕНЕНИЕ МИГРАЦИЙ

docker-compose -f docker-compose.test.yml exec app-test poetry run alembic upgrade head

НАПОЛНЕНИЕ ТЕСТОВЫМИ ДАННЫМИ

cd tests/load
poetry run python seed_data.py

ЗАПУСК LOCUST (Web UI)

poetry run locust -f tests/load/locustfile.py --host=http://localhost:8001

Откройте браузер: http://localhost:8089

ЗАПУСК LOCUST (Headless)

poetry run locust -f tests/load/locustfile.py \
  --headless \
  --users=50 \
  --spawn-rate=5 \
  --run-time=10m \
  --html=tests/load/results/report.html \
  --csv=tests/load/results/stats

ОСТАНОВКА ОКРУЖЕНИЯ

docker-compose -f docker-compose.test.yml down

================================================================================
СТРУКТУРА ФАЙЛОВ
================================================================================

tests/load/
├── README.txt                      # Этот файл
├── locustfile.py                   # Основной файл Locust
├── seed_data.py                    # Наполнение тестовыми данными
├── compare_results.py              # Сравнение результатов
├── run_baseline_test.bat           # Скрипт baseline тестов
├── run_optimized_test.bat          # Скрипт optimized тестов
├── scenarios/                      # Сценарии тестирования (будущее)
└── results/
    ├── baseline/                   # Результаты ДО рефакторинга
    │   ├── report_10users.html
    │   ├── report_50users.html
    │   ├── report_100users.html
    │   ├── stats_50users_stats.csv
    │   └── resource_usage.txt
    ├── optimized/                  # Результаты ПОСЛЕ рефакторинга
    │   ├── report_10users.html
    │   ├── report_50users.html
    │   ├── report_100users.html
    │   ├── stats_50users_stats.csv
    │   └── resource_usage.txt
    └── comparison_report.txt       # Отчет сравнения

================================================================================
СЦЕНАРИИ ТЕСТИРОВАНИЯ
================================================================================

ТЕСТ 1: Низкая нагрузка
Пользователи: 10
Spawn rate: 1 user/sec
Длительность: 5 минут
Цель: Проверить стабильность

ТЕСТ 2: Средняя нагрузка
Пользователи: 50
Spawn rate: 5 users/sec
Длительность: 10 минут
Цель: Рабочая нагрузка

ТЕСТ 3: Высокая нагрузка
Пользователи: 100
Spawn rate: 10 users/sec
Длительность: 10 минут
Цель: Пиковая нагрузка

ТЕСТ 4: Стресс-тест (опционально)
Пользователи: 200
Spawn rate: 20 users/sec
Длительность: 5 минут
Цель: Найти точку отказа

================================================================================
МЕТРИКИ
================================================================================

ПРОИЗВОДИТЕЛЬНОСТЬ
- Response Time (median, p95, p99)
- Requests per Second (RPS)
- Error Rate

РЕСУРСЫ
- CPU Usage
- Memory Usage
- Database Connections
- Redis Connections

ОЖИДАЕМЫЕ УЛУЧШЕНИЯ

Response Time (p95): -30% до -50%
RPS: +50% до +100%
Error Rate: -50% до -90%
CPU Usage: -20% до -40%

================================================================================
TROUBLESHOOTING
================================================================================

ПРОБЛЕМА: Тестовое окружение не запускается
Решение: Проверить docker-compose.test.yml и .env.test

ПРОБЛЕМА: Seed data не создается
Решение: Проверить подключение к БД, применить миграции

ПРОБЛЕМА: Locust не запускается
Решение: Установить зависимости (poetry install)

ПРОБЛЕМА: Высокий error rate
Решение: Проверить логи приложения, увеличить timeout

================================================================================
СЛЕДУЮЩИЕ ШАГИ
================================================================================

1. Запустить baseline тесты
2. Сохранить результаты
3. Выполнить рефакторинг
4. Запустить optimized тесты
5. Сравнить результаты
6. Задокументировать выводы

================================================================================
СТАТУС: ГОТОВ К ЗАПУСКУ
================================================================================
